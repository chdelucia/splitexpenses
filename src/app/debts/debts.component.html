
<main class="container-md mb-5">

  <h2 class="my-4 text-center" i18n>Deudas</h2>
  <section class="row g-4">
    <ng-container *ngIf="debts.size">
      <div class="col-sm-12 col-lg-6 col-xxl-4" *ngFor="let user of users$ | async"
      [class.order-2]="debts.get(user.id)!.totalIowe <= 0">
      <div class="persoanlDebts p-md-3 p-2" routerLink='/debts/details'>
        <div class="d-flex flex-row justify-content-between title">
            <div>{{user.name}}</div>
            <div class="totalIowe">
                {{debts.get(user.id)?.totalIowe}} {{currency.currencySymbol}}
                <div *ngIf="currency.active" class="text-end mainExchange">
                    {{ calcExchange(debts.get(user.id)?.totalIowe) }}
                    {{currency.currencyExchangeSymbol}}
                </div>

              </div>
            </div>
              <ng-container *ngFor="let person of users$ | async">
                  <div class="d-flex flex-row justify-content-between align-items-center text-secondary py-1 subtitle"
                      *ngIf="user.id !== person.id">
                      <div>{{person.name}}</div>
                      <div>
                          <ng-container *ngIf="debts.get(user.id)?.debts?.get(person.id)?.individualtotalIveBeenPaid !=
                                                      debts.get(user.id)?.debts?.get(person.id)?.newDebt; else elseBlock">

                              {{debts.get(user.id)?.debts?.get(person.id)?.newDebt | number:'.0-2' }}
                              {{currency.currencySymbol}}
                              <small *ngIf="currency.active && debts.get(user.id)?.debts?.get(person.id)?.newDebt !== 0" class="text-end">
                                  {{ calcExchange(debts.get(user.id)?.debts?.get(person.id)?.newDebt) }}
                                  {{currency.currencyExchangeSymbol}}
                              </small>

                          </ng-container>

                          <ng-template #elseBlock>
                              {{debts.get(user.id)?.debts?.get(person.id)?.individualtotalIveBeenPaid }}
                              {{currency.currencySymbol}}
                              <small *ngIf="currency.active && debts.get(user.id)?.debts?.get(person.id)?.individualtotalIveBeenPaid !== 0" class="text-end">
                                  {{ calcExchange(debts.get(user.id)?.debts?.get(person.id)?.individualtotalIveBeenPaid) }}
                                  {{currency.currencyExchangeSymbol}}
                              </small>
                          </ng-template>
                      </div>
                  </div>
              </ng-container>
          </div>
    </div>
    </ng-container>
  </section>

<app-debt-tracing [debtTracing]="debtTracing"></app-debt-tracing>

</main>
